<!DOCTYPE html>
<html lang="ru">
<head>
    <title>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</title>
    <meta charset="utf-8">
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f6f8fa;
            --bg-tertiary: #fafbfc;
            --border-primary: #e1e4e8;
            --border-secondary: #d1d5da;
            --text-primary: #24292e;
            --text-secondary: #586069;
            --text-tertiary: #6a737d;
            --accent-color: #0366d6;
            --accent-hover: #0256c7;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            --shadow-hover: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
        }

        .dark-theme {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-primary: #30363d;
            --border-secondary: #3b424a;
            --text-primary: #f0f6fc;
            --text-secondary: #c9d1d9;
            --text-tertiary: #8b949e;
            --accent-color: #58a6ff;
            --accent-hover: #4493f1;
            --success-color: #3fb950;
            --warning-color: #d29922;
            --danger-color: #f85149;
            --shadow: 0 1px 3px rgba(0,0,0,0.5), 0 1px 2px rgba(0,0,0,0.4);
            --shadow-hover: 0 3px 6px rgba(0,0,0,0.6), 0 3px 6px rgba(0,0,0,0.5);
        }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif; 
            margin: 0; 
            padding: 0;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }

        .header { 
            background: var(--bg-secondary); 
            padding: 16px 0;
            border-bottom: 1px solid var(--border-primary);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav { 
            display: flex;
            gap: 8px;
        }

        .nav a { 
            text-decoration: none; 
            color: var(--text-secondary);
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            transition: background-color 0.2s, color 0.2s;
        }

        .nav a:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .nav a.active {
            background: var(--accent-color);
            color: white;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 16px;
        }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: 6px;
            padding: 8px 12px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background-color 0.2s;
        }

        .theme-toggle:hover {
            background: var(--bg-secondary);
        }

        .logout-btn {
            color: var(--danger-color) !important;
        }

        .logout-btn:hover {
            background: rgba(220, 53, 69, 0.1) !important;
        }

        .database-overview {
            background: var(--bg-secondary);
            padding: 24px;
            border-radius: 6px;
            border: 1px solid var(--border-primary);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-tertiary);
            padding: 16px;
            border-radius: 6px;
            border: 1px solid var(--border-primary);
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 600;
            color: var(--accent-color);
            margin: 8px 0;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .table-section {
            background: var(--bg-secondary);
            padding: 24px;
            border-radius: 6px;
            border: 1px solid var(--border-primary);
            margin-bottom: 24px;
            box-shadow: var(--shadow);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .table-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .table-count {
            background: var(--accent-color);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .table-container {
            overflow-x: auto;
            border: 1px solid var(--border-primary);
            border-radius: 6px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th {
            background: var(--bg-tertiary);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid var(--border-primary);
            color: var(--text-secondary);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid var(--border-primary);
        }

        tr:hover {
            background: var(--bg-tertiary);
        }

        .column-type {
            font-size: 12px;
            color: var(--text-tertiary);
            font-family: monospace;
        }

        .empty-state {
            padding: 40px 20px;
            text-align: center;
            color: var(--text-tertiary);
        }

        .empty-state h3 {
            margin: 0 0 8px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .empty-state p {
            margin: 0;
            font-size: 14px;
        }

        .json-view {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-primary);
            margin-bottom: 16px;
        }

        .tab {
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab.active {
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
        }

        .tab:hover {
            color: var(--text-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .search-box {
            margin-bottom: 16px;
        }

        .search-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-primary);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
        }

        .search-input:focus {
            border-color: var(--accent-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.3);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="header-content">
                <h1>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 5v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2zm16 14H5V5h14v14zM7 7h10v2H7V7zm0 4h10v2H7v-2zm0 4h7v2H7v-2z"/>
                    </svg>
                    –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                </h1>
                <div style="display: flex; align-items: center; gap: 16px;">
                    <button class="theme-toggle" id="themeToggle">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
                        </svg>
                        –¢–µ–º–∞
                    </button>
                    <div class="nav">
                        <a href="/dashboard">üìä –î–∞—à–±–æ—Ä–¥</a>
                        <a href="/tickets">üé´ –¢–∏–∫–µ—Ç—ã</a>
                        <a href="/database" class="active">üóÉÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</a>
                        <a href="/logout" class="logout-btn">üö™ –í—ã–π—Ç–∏</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- –û–±–∑–æ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö -->
        <div class="database-overview">
            <h2 class="section-title">üìä –û–±–∑–æ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">{{ db_stats.total_tables }}</div>
                    <div class="stat-label">–¢–∞–±–ª–∏—Ü –≤ –ë–î</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ db_stats.total_records }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ db_stats.total_users }}</div>
                    <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ db_stats.total_tickets }}</div>
                    <div class="stat-label">–¢–∏–∫–µ—Ç–æ–≤</div>
                </div>
            </div>
        </div>

        <!-- –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö -->
        <div class="database-overview">
            <h2 class="section-title">üîç –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</h2>
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º...">
            </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü -->
        {% for table_name, table_info in db_info.items() %}
        <div class="table-section">
            <div class="table-header">
                <div class="table-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 17h18c.55 0 1-.45 1-1s-.45-1-1-1H3c-.55 0-1 .45-1 1s.45 1 1 1zm0-4h18c.55 0 1-.45 1-1s-.45-1-1-1H3c-.55 0-1 .45-1 1s.45 1 1 1zm0-4h18c.55 0 1-.45 1-1s-.45-1-1-1H3c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h18c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"/>
                    </svg>
                    {{ table_name }}
                </div>
                <div class="table-count">{{ table_info.count }} –∑–∞–ø–∏—Å–µ–π</div>
            </div>

            <div class="tabs">
                <div class="tab active" data-tab="structure-{{ table_name }}">–°—Ç—Ä—É–∫—Ç—É—Ä–∞</div>
                <div class="tab" data-tab="data-{{ table_name }}">–î–∞–Ω–Ω—ã–µ</div>
                {% if table_name == 'support_tickets' %}
                <div class="tab" data-tab="stats-{{ table_name }}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                {% endif %}
            </div>

            <!-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã -->
            <div class="tab-content active" id="structure-{{ table_name }}">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>–ò–º—è —Å—Ç–æ–ª–±—Ü–∞</th>
                                <th>–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö</th>
                                <th>–†–∞–∑–º–µ—Ä</th>
                                <th>NULL</th>
                                <th>–ö–ª—é—á</th>
                                <th>–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</th>
                                <th>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for column in table_info.columns %}
                            <tr>
                                <td><strong>{{ column[1] }}</strong></td>
                                <td><code class="column-type">{{ column[2] }}</code></td>
                                <td>{{ column[3] or '-' }}</td>
                                <td>{{ 'YES' if column[4] else 'NO' }}</td>
                                <td>{{ column[5] or '-' }}</td>
                                <td>{{ column[6] or 'NULL' }}</td>
                                <td>{{ column[7] or '-' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- –î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã -->
            <div class="tab-content" id="data-{{ table_name }}">
                {% if table_info.data %}
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                {% for column in table_info.columns %}
                                <th>{{ column[1] }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in table_info.data %}
                            <tr>
                                {% for value in row %}
                                <td>
                                    {% if value is none %}
                                        <span style="color: var(--text-tertiary); font-style: italic;">NULL</span>
                                    {% elif value is string and value|length > 100 %}
                                        {{ value[:100] }}...
                                    {% elif value is mapping %}
                                        <div class="json-view">{{ value | tojson }}</div>
                                    {% else %}
                                        {{ value }}
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="empty-state">
                    <h3>üòî –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                    <p>–¢–∞–±–ª–∏—Ü–∞ {{ table_name }} –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–ø–∏—Å–µ–π</p>
                </div>
                {% endif %}
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã —Ç–∏–∫–µ—Ç–æ–≤ -->
            {% if table_name == 'support_tickets' %}
            <div class="tab-content" id="stats-{{ table_name }}">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">{{ table_info.stats.open }}</div>
                        <div class="stat-label">–û—Ç–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ table_info.stats.in_progress }}</div>
                        <div class="stat-label">–¢–∏–∫–µ—Ç–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ table_info.stats.resolved }}</div>
                        <div class="stat-label">–†–µ—à–µ–Ω–Ω—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ table_info.stats.avg_response_time }}</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (—á)</div>
                    </div>
                </div>
                
                <h4 style="margin: 20px 0 12px 0;">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º:</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>–¢–∏–ø —Ç–∏–∫–µ—Ç–∞</th>
                                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for type, count in table_info.stats.by_type.items() %}
                            <tr>
                                <td>{{ type }}</td>
                                <td>{{ count }}</td>
                                <td>{{ "%.1f"|format((count / table_info.count) * 100) }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}
        </div>
        {% endfor %}

        <!-- SQL-–∑–∞–ø—Ä–æ—Å—ã -->
        <div class="table-section">
            <div class="table-header">
                <div class="table-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 17h18c.55 0 1-.45 1-1s-.45-1-1-1H3c-.55 0-1 .45-1 1s.45 1 1 1zm0-4h18c.55 0 1-.45 1-1s-.45-1-1-1H3c-.55 0-1 .45-1 1s.45 1 1 1zm0-4h18c.55 0 1-.45 1-1s-.45-1-1-1H3c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h18c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"/>
                    </svg>
                    SQL-–∑–∞–ø—Ä–æ—Å—ã
                </div>
            </div>
            
            <div style="margin-bottom: 16px;">
                <textarea id="sqlQuery" placeholder="–í–≤–µ–¥–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å..." style="width: 100%; height: 100px; padding: 12px; border: 1px solid var(--border-primary); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary); font-family: monospace;"></textarea>
            </div>
            <div>
                <button class="theme-toggle" onclick="executeQuery()" style="background: var(--accent-color); color: white;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                    –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
                </button>
            </div>
            <div id="queryResult" style="margin-top: 16px;"></div>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (body.classList.contains('dark-theme')) {
                body.classList.remove('dark-theme');
                localStorage.setItem('theme', 'light');
                themeToggle.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
                    </svg>
                    –¢–µ–º–∞
                `;
            } else {
                body.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark');
                themeToggle.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 9c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3z"/>
                        <path d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zm-2 5.79V18h-3.52L12 20.48 9.52 18H6v-3.52L3.52 12 6 9.52V6h3.52L12 3.52 14.48 6H18v3.52L20.48 12 18 14.48z"/>
                    </svg>
                    –¢–µ–º–∞
                `;
            }
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Ç–µ–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            const themeToggle = document.getElementById('themeToggle');
            
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                themeToggle.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 9c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3z"/>
                        <path d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zm-2 5.79V18h-3.52L12 20.48 9.52 18H6v-3.52L3.52 12 6 9.52V6h3.52L12 3.52 14.48 6H18v3.52L20.48 12 18 14.48z"/>
                    </svg>
                    –¢–µ–º–∞
                `;
            }
            
            themeToggle.addEventListener('click', toggleTheme);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    const parentSection = this.closest('.table-section');
                    
                    // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç—ã –≤ —ç—Ç–æ–π —Å–µ–∫—Ü–∏–∏
                    parentSection.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    parentSection.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É –∏ –∫–æ–Ω—Ç–µ–Ω—Ç
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });

            // –ü–æ–∏—Å–∫ –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º
            document.getElementById('searchInput').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                document.querySelectorAll('.table-section').forEach(section => {
                    let hasMatch = false;
                    
                    // –ü–æ–∏—Å–∫ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö —Ç–∞–±–ª–∏—Ü
                    const tableTitle = section.querySelector('.table-title').textContent.toLowerCase();
                    if (tableTitle.includes(searchTerm)) {
                        hasMatch = true;
                    }
                    
                    // –ü–æ–∏—Å–∫ –≤ –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
                    section.querySelectorAll('td').forEach(cell => {
                        if (cell.textContent.toLowerCase().includes(searchTerm)) {
                            hasMatch = true;
                            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
                            const text = cell.textContent;
                            const regex = new RegExp(`(${searchTerm})`, 'gi');
                            cell.innerHTML = text.replace(regex, '<mark style="background: yellow; color: black;">$1</mark>');
                        }
                    });
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Å–µ–∫—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
                    section.style.display = hasMatch || searchTerm === '' ? 'block' : 'none';
                });
            });
        });

        // –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–∞
        function executeQuery() {
            const query = document.getElementById('sqlQuery').value;
            const resultDiv = document.getElementById('queryResult');
            
            if (!query.trim()) {
                resultDiv.innerHTML = '<div class="error" style="padding: 12px; background: rgba(220, 53, 69, 0.1); color: var(--danger-color); border-radius: 6px;">–í–≤–µ–¥–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div style="padding: 12px; background: rgba(3, 102, 214, 0.1); color: var(--accent-color); border-radius: 6px;">–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞...</div>';
            
            fetch('/api/database/query', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ query: query })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    if (data.results && data.results.length > 0) {
                        let html = '<div class="table-container"><table><thead><tr>';
                        
                        // –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
                        Object.keys(data.results[0]).forEach(key => {
                            html += `<th>${key}</th>`;
                        });
                        html += '</tr></thead><tbody>';
                        
                        // –î–∞–Ω–Ω—ã–µ
                        data.results.forEach(row => {
                            html += '<tr>';
                            Object.values(row).forEach(value => {
                                html += `<td>${value !== null ? value : '<span style="color: var(--text-tertiary); font-style: italic;">NULL</span>'}</td>`;
                            });
                            html += '</tr>';
                        });
                        
                        html += '</tbody></table></div>';
                        resultDiv.innerHTML = html;
                    } else {
                        resultDiv.innerHTML = '<div class="success" style="padding: 12px; background: rgba(40, 167, 69, 0.1); color: var(--success-color); border-radius: 6px;">–ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ. –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</div>';
                    }
                } else {
                    resultDiv.innerHTML = `<div class="error" style="padding: 12px; background: rgba(220, 53, 69, 0.1); color: var(--danger-color); border-radius: 6px;">–û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            })
            .catch(error => {
                resultDiv.innerHTML = `<div class="error" style="padding: 12px; background: rgba(220, 53, 69, 0.1); color: var(--danger-color); border-radius: 6px;">–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ${error}</div>`;
            });
        }
    </script>
</body>
</html>
